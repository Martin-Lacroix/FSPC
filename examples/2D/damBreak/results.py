import os,sys
sys.path.append('examples')
import toolbox as tb
import gmsh

# |-------------------------------|
# |   Data From the Literature    |
# |-------------------------------|

data = list()

# Cerquaglia results

data.append(
[[0.00000,0.000000],
[0.000469,0.000228],
[0.022873,0.000337],
[0.045284,0.000104],
[0.067693,0.000098],
[0.090101,0.000208],
[0.112509,0.000317],
[0.131188,-0.00025],
[0.137728,-0.00071],
[0.139585,0.000425],
[0.146092,0.003505],
[0.150730,0.006815],
[0.157237,0.009895],
[0.159082,0.012292],
[0.161854,0.015488],
[0.166502,0.017656],
[0.167418,0.019482],
[0.170190,0.022678],
[0.173901,0.025188],
[0.178538,0.028612],
[0.180381,0.031237],
[0.185031,0.033177],
[0.191532,0.036942],
[0.193383,0.038654],
[0.196165,0.040708],
[0.201755,0.042077],
[0.212005,0.044244],
[0.220397,0.045497],
[0.238142,0.045037],
[0.248429,0.043208],
[0.260587,0.041150],
[0.269944,0.038979],
[0.280242,0.036123],
[0.290534,0.033838],
[0.303629,0.031323],
[0.315792,0.028695],
[0.328885,0.026409],
[0.341035,0.025150],
[0.352254,0.023550],
[0.366272,0.022291],
[0.380285,0.021488],
[0.395239,0.019887],
[0.412983,0.019540],
[0.429798,0.018623],
[0.445679,0.017820],
[0.459689,0.017361],
[0.478370,0.016557],
[0.502651,0.016095],
[0.526000,0.015405],
[0.545609,0.015286],
[0.563345,0.015739],
[0.574557,0.014937],
[0.580177,0.012995],
[0.583930,0.011054],
[0.589552,0.008998],
[0.593308,0.006714],
[0.601731,0.004657],
[0.609222,0.002372],
[0.613911,0.000088],
[0.616739,-0.00276],
[0.621435,-0.00573],
[0.624262,-0.00847],
[0.628955,-0.01110],
[0.630844,-0.01338],
[0.634602,-0.01589],
[0.641160,-0.01818],
[0.650510,-0.01966],
[0.662657,-0.02058],
[0.676675,-0.02184],
[0.684132,-0.02059],
[0.689713,-0.01830],
[0.694357,-0.01568],
[0.703664,-0.01237],
[0.711091,-0.00781],
[0.715728,-0.00450],
[0.723163,-0.00073],
[0.727797,0.002916],
[0.733368,0.006339],
[0.739867,0.010219],
[0.746372,0.013528],
[0.758484,0.016379],
[0.770635,0.015006],
[0.779058,0.012836],
[0.785613,0.010893],
[0.794038,0.008494],
[0.802468,0.005638],
[0.809969,0.002326],
[0.815594,-0.00007],
[0.823092,-0.00315],
[0.830587,-0.00589],
[0.842759,-0.00943],
[0.851189,-0.01229],
[0.863359,-0.01572],
[0.876451,-0.01789],
[0.888594,-0.01846],
[0.904460,-0.01767],
[0.920321,-0.01642],
[0.931505,-0.01414],
[0.947345,-0.01060],
[0.958517,-0.00718],
[0.971558,-0.00387],
[0.982736,-0.00102],
[0.998578,0.002283]])

# Meduri results

data.append(
[[0.00000,0.000000],
[0.004197,0.000455],
[0.022872,0.000451],
[0.039680,0.000219],
[0.056487,0.000215],
[0.075158,0.000553],
[0.092899,0.000549],
[0.108773,0.000432],
[0.124649,0.000085],
[0.138651,0.000425],
[0.144232,0.002707],
[0.147020,0.004190],
[0.153525,0.007499],
[0.157234,0.010238],
[0.158145,0.012635],
[0.162789,0.015259],
[0.166499,0.017998],
[0.171141,0.020851],
[0.172051,0.023362],
[0.176687,0.026786],
[0.179466,0.029183],
[0.184107,0.032150],
[0.189686,0.034660],
[0.194335,0.036713],
[0.196179,0.039224],
[0.200823,0.041849],
[0.205470,0.044131],
[0.219449,0.046982],
[0.244651,0.047889],
[0.262416,0.045260],
[0.274583,0.042175],
[0.292346,0.039773],
[0.302647,0.036460],
[0.312013,0.033376],
[0.330713,0.030632],
[0.345682,0.027432],
[0.358781,0.024575],
[0.382140,0.022858],
[0.399903,0.020342],
[0.425119,0.019766],
[0.425119,0.019766],
[0.447544,0.018048],
[0.471829,0.017130],
[0.494254,0.015412],
[0.517604,0.014608],
[0.543756,0.013688],
[0.563381,0.011857],
[0.584835,0.014136],
[0.600725,0.012306],
[0.606361,0.008765],
[0.612928,0.005453],
[0.615761,0.002028],
[0.618595,-0.00151],
[0.623293,-0.00470],
[0.627996,-0.00836],
[0.633628,-0.01156],
[0.640197,-0.01510],
[0.649562,-0.01807],
[0.659865,-0.02149],
[0.672964,-0.02446],
[0.693495,-0.02333],
[0.703735,-0.02002],
[0.712112,-0.01717],
[0.722351,-0.01375],
[0.731656,-0.01032],
[0.737229,-0.00724],
[0.742801,-0.00393],
[0.748370,-0.00039],
[0.752073,0.003024],
[0.759513,0.006105],
[0.768818,0.009642],
[0.776257,0.012836],
[0.784633,0.015802],
[0.799546,0.018653],
[0.814511,0.015910],
[0.821076,0.012712],
[0.832312,0.009399],
[0.840745,0.006201],
[0.850115,0.002660],
[0.853882,-0.00076],
[0.860448,-0.00396],
[0.867948,-0.00727],
[0.878248,-0.01036],
[0.893215,-0.01333],
[0.910047,-0.01607],
[0.931522,-0.01596],
[0.952046,-0.01414],
[0.976304,-0.01220],
[0.996840,-0.01152]])

# Ryzhakov results

data.append(
[[0.00000,0.000000],
[0.007001,0.000226],
[0.023809,0.000109],
[0.038748,0.000105],
[0.058355,0.000215],
[0.074228,0.000211],
[0.091968,0.000207],
[0.109709,0.000203],
[0.124657,-0.00071],
[0.133981,0.000654],
[0.142376,0.001565],
[0.148889,0.003961],
[0.155405,0.006129],
[0.158186,0.008297],
[0.161889,0.011721],
[0.163739,0.013547],
[0.168379,0.016628],
[0.170230,0.018340],
[0.174875,0.020850],
[0.176721,0.023133],
[0.180433,0.025644],
[0.181349,0.027470],
[0.185990,0.030437],
[0.190645,0.031920],
[0.195285,0.035001],
[0.201796,0.037625],
[0.207378,0.039793],
[0.218561,0.042073],
[0.225091,0.042757],
[0.239092,0.043210],
[0.248445,0.041496],
[0.266203,0.039665],
[0.276496,0.037265],
[0.288652,0.035322],
[0.306426,0.031779],
[0.327004,0.027893],
[0.349450,0.023893],
[0.379359,0.020689],
[0.407388,0.018742],
[0.421402,0.017826],
[0.444749,0.017364],
[0.456894,0.016676],
[0.483975,0.016328],
[0.503583,0.016209],
[0.525059,0.016204],
[0.536268,0.015745],
[0.559628,0.013799],
[0.592324,0.012079],
[0.605411,0.010478],
[0.612904,0.007965],
[0.621349,0.003511],
[0.626993,-0.00094],
[0.626071,-0.00219],
[0.635442,-0.00585],
[0.641069,-0.00848],
[0.657888,-0.00985],
[0.665373,-0.01145],
[0.675656,-0.01271],
[0.693360,-0.00883],
[0.703588,-0.00427],
[0.718489,-0.00016],
[0.729650,0.004514],
[0.744549,0.008848],
[0.762251,0.012954],
[0.774362,0.015805],
[0.783719,0.013748],
[0.789335,0.012262],
[0.797754,0.010548],
[0.807113,0.008149],
[0.811802,0.005979],
[0.817420,0.004265],
[0.823982,0.001524],
[0.828695,-0.00327],
[0.833383,-0.00532],
[0.836203,-0.00738],
[0.841830,-0.01001],
[0.849321,-0.01229],
[0.866166,-0.01640],
[0.897007,-0.01949],
[0.911010,-0.01915],
[0.927803,-0.01767],
[0.940858,-0.01585],
[0.947367,-0.01300],
[0.956694,-0.01197],
[0.960398,-0.00866],
[0.967855,-0.00729],
[0.975306,-0.00524],
[0.990227,-0.00330],
[0.995815,-0.00182]])

# Zhu results

data.append(
[[0.00000,0.000000],
[0.005134,0.000113],
[0.021941,0.000109],
[0.040613,0.000333],
[0.058356,0.000101],
[0.076096,0.000097],
[0.091969,0.000093],
[0.112509,0.000317],
[0.124652,-0.00025],
[0.138650,0.000539],
[0.144229,0.003049],
[0.149812,0.005103],
[0.154456,0.007727],
[0.157230,0.010694],
[0.159072,0.013434],
[0.162789,0.015259],
[0.168360,0.018683],
[0.170201,0.021422],
[0.174835,0.025188],
[0.180407,0.028383],
[0.185991,0.030323],
[0.189704,0.032719],
[0.191553,0.034659],
[0.195270,0.036599],
[0.200845,0.039452],
[0.206433,0.041049],
[0.213891,0.042303],
[0.222282,0.043556],
[0.231619,0.043554],
[0.243772,0.042067],
[0.252191,0.040353],
[0.259669,0.039438],
[0.266217,0.038181],
[0.271835,0.036467],
[0.276522,0.034526],
[0.283069,0.033268],
[0.287755,0.031441],
[0.293369,0.030184],
[0.300855,0.028470],
[0.302736,0.026985],
[0.311155,0.025271],
[0.316769,0.024014],
[0.324255,0.022300],
[0.334545,0.020243],
[0.345766,0.018414],
[0.360724,0.016470],
[0.380341,0.015438],
[0.403693,0.014519],
[0.428904,0.014400],
[0.450376,0.014737],
[0.469981,0.015075],
[0.486787,0.015071],
[0.505466,0.014610],
[0.517608,0.014151],
[0.535358,0.013120],
[0.540971,0.011977],
[0.550321,0.010605],
[0.556865,0.009804],
[0.568079,0.008774],
[0.583960,0.007857],
[0.585846,0.005916],
[0.590491,0.004713],
[0.592412,0.002718],
[0.600836,0.000433],
[0.601791,-0.00185],
[0.606483,-0.00436],
[0.612108,-0.00676],
[0.614927,-0.00870],
[0.618681,-0.01075],
[0.625241,-0.01327],
[0.628997,-0.01555],
[0.635557,-0.01818],
[0.641183,-0.02069],
[0.649603,-0.02252],
[0.658015,-0.02343],
[0.666427,-0.02435],
[0.683215,-0.02230],
[0.691596,-0.01990],
[0.699041,-0.01728],
[0.702749,-0.01443],
[0.710192,-0.01157],
[0.715766,-0.00849],
[0.722273,-0.00541],
[0.727848,-0.00256],
[0.735289,0.000517],
[0.742728,0.003826],
[0.751101,0.007134],
[0.760416,0.009415],
[0.771606,0.011011],
[0.784669,0.011921],
[0.797753,0.010662],
[0.804303,0.009177],
[0.810858,0.007121],
[0.816474,0.005635],
[0.823037,0.002780],
[0.832398,0.000152],
[0.838026,-0.00258],
[0.848320,-0.00510],
[0.853944,-0.00738],
[0.864233,-0.00933],
[0.877329,-0.01195],
[0.893213,-0.01310],
[0.916555,-0.01299],
[0.935224,-0.01254],
[0.954826,-0.01186],
[0.974422,-0.01061],
[0.984682,-0.00947],
[0.996810,-0.00833]])

# |--------------------------------|
# |   Post Procesing of Results    |
# |--------------------------------|

X = list()
position = [0.292,0.08,0]
os.chdir('workspace/metafor')

time,directory = tb.readFiles()
tag = tb.findNode(directory[0],position)

for file in directory:

    gmsh.open(file)
    X.append(gmsh.model.mesh.getNode(tag)[0][0])

tb.plotRef(time,X-X[0],data)