import os, sys
import numpy as np
sys.path.append('examples')
import toolbox as tb
import gmsh

# |-------------------------------|
# |   Data From the Literature    |
# |-------------------------------|

data = list()

# Antoci results

data.append(
[[0.00000, 0.000000],
[0.015385, 0.002747],
[0.030769, 0.009440],
[0.046154, 0.018806],
[0.061538, 0.030013],
[0.076923, 0.037971],
[0.092308, 0.043791],
[0.107692, 0.048510],
[0.123077, 0.051473],
[0.138462, 0.052998],
[0.153846, 0.053632],
[0.169231, 0.052906],
[0.184615, 0.051703],
[0.200000, 0.050197],
[0.215385, 0.048848],
[0.230769, 0.048228],
[0.246154, 0.047714],
[0.261538, 0.047293],
[0.276923, 0.046924],
[0.292308, 0.046568],
[0.307692, 0.046301],
[0.323077, 0.046115],
[0.338462, 0.045797],
[0.353846, 0.045467],
[0.369231, 0.045020],
[0.384615, 0.044192],
[0.400000, 0.043370]])

# Cerquaglia results

data.append(
[[0.00000, 0.000000],
[0.015385, 0.002409],
[0.030769, 0.009166],
[0.046154, 0.019869],
[0.061538, 0.031433],
[0.076923, 0.041390],
[0.092308, 0.047760],
[0.107692, 0.051770],
[0.123077, 0.053951],
[0.138462, 0.054511],
[0.153846, 0.054148],
[0.169231, 0.053230],
[0.184615, 0.051871],
[0.200000, 0.050306],
[0.215385, 0.048712],
[0.230769, 0.047214],
[0.246154, 0.045757],
[0.261538, 0.044341],
[0.276923, 0.043075],
[0.292308, 0.041918],
[0.307692, 0.040739],
[0.323077, 0.039744],
[0.338462, 0.038999],
[0.353846, 0.038477],
[0.369231, 0.038181],
[0.384615, 0.037791],
[0.400000, 0.037448]])

# Experimental results

data.append(
[[0.00000, 0.000000],
[0.039651, 0.012952],
[0.079229, 0.035086],
[0.120165, 0.046367],
[0.160494, 0.049079],
[0.200857, 0.046634],
[0.239829, 0.044758],
[0.279657, 0.042728],
[0.319914, 0.041619],
[0.360082, 0.038567],
[0.398715, 0.038633]])

# Meng results

data.append(
[[0.00000, 0.000000],
[0.015385, 0.002720],
[0.030769, 0.009966],
[0.046154, 0.019926],
[0.061538, 0.030791],
[0.076923, 0.039339],
[0.092308, 0.045389],
[0.107692, 0.048688],
[0.123077, 0.050175],
[0.138462, 0.050497],
[0.153846, 0.049705],
[0.169231, 0.048454],
[0.184615, 0.046924],
[0.200000, 0.045173],
[0.215385, 0.043522],
[0.230769, 0.041908],
[0.246154, 0.040330],
[0.261538, 0.038895],
[0.276923, 0.037749],
[0.292308, 0.036754],
[0.307692, 0.035897],
[0.323077, 0.035369],
[0.338462, 0.034925],
[0.353846, 0.034520],
[0.369231, 0.034342],
[0.384615, 0.034165],
[0.400000, 0.034006]])

# |--------------------------------|
# |   Post Procesing of Results    |
# |--------------------------------|

D = list()
position = [0.1, 0, 0]
os.chdir('workspace/metafor')

time, directory = tb.read_files()
tag = tb.find_node(directory[0], position)

for file in directory:

    gmsh.open(file)
    D.append(gmsh.model.mesh.getNode(tag)[0])

disp = np.linalg.norm(D - D[0], axis=1)
tb.plot_ref(time, disp, data)
