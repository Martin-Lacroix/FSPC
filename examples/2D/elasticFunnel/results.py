import os,sys
sys.path.append('examples')
import toolbox as tb
import gmsh

# |-------------------------------|
# |   Data From the Literature    |
# |-------------------------------|

data = list()

# Cerquaglia results

data.append(
[[0.00000,0.000000],
[0.052794,-0.00280],
[0.305542,-0.00273],
[0.547302,-0.00266],
[0.821982,-0.00540],
[0.920651,-0.01946],
[0.974946,-0.05888],
[0.951204,-0.16593],
[0.971603,-0.26170],
[0.969421,-0.39409],
[1.022230,-0.52365],
[0.998395,-0.63634],
[1.039751,-0.79407],
[1.080782,-0.97153],
[1.151127,-0.70390],
[1.186231,-0.57431],
[1.231626,-0.48698],
[1.287082,-0.45597],
[1.377702,-0.48164],
[1.471984,-0.47503],
[1.530864,-0.53866],
[1.564602,-0.56937],
[1.675247,-0.60885],
[1.742941,-0.65711],
[1.836681,-0.68342],
[1.965859,-0.63729],
[2.121300,-0.55605],
[2.217753,-0.41777],
[2.332305,-0.22022],
[2.404051,-0.02269],
[2.442094,0.207743],
[2.460121,0.262613],
[2.652917,0.532598],
[2.686765,0.508467],
[2.727111,0.359249],
[2.758245,0.170525],
[2.806610,-0.01161],
[2.863030,-0.22446],
[2.885892,-0.39563],
[2.926202,-0.54705],
[3.001191,-0.67211],
[3.034785,-0.71161],
[3.088142,-0.59089],
[3.141427,-0.47456],
[3.177264,-0.37799],
[3.306695,-0.31651],
[3.373630,-0.41086],
[3.406392,-0.50082],
[3.431460,-0.53812],
[3.499082,-0.59078],
[3.561507,-0.43933],
[3.623570,-0.30984],
[3.624293,-0.26594],
[3.796567,-0.20225],
[3.901256,-0.08372],
[3.977475,-0.13417],
[4.028372,-0.16269],
[4.136376,-0.36236],
[4.222568,-0.32722],
[4.357847,-0.43033],
[4.417451,-0.45006],
[4.501942,-0.51807],
[4.633797,-0.30955],
[4.772947,-0.17784],
[4.866687,-0.20415],
[4.961548,-0.16242],
[5.037405,-0.23482],
[5.121354,-0.33575],
[5.222389,-0.43886],
[5.291204,-0.41909],
[5.394120,-0.40809],
[5.480275,-0.37515],
[5.549452,-0.33343],
[5.635897,-0.28293],
[5.738559,-0.28729],
[5.926979,-0.28285],
[6.020357,-0.33111],
[6.105210,-0.37717],
[6.173447,-0.39251],
[6.311005,-0.35736],
[6.414391,-0.31783],
[6.534755,-0.28707],
[6.679971,-0.30678],
[6.893279,-0.35061],
[7.132632,-0.37249],
[7.244398,-0.34393],
[7.330626,-0.30660],
[7.450809,-0.28681],
[7.604730,-0.29774],
[7.758109,-0.34159],
[7.946203,-0.35690],
[8.143184,-0.35245],
[8.315060,-0.31290],
[8.478050,-0.29311],
[8.640171,-0.32598],
[8.819631,-0.34568],
[9.068016,-0.33903],
[9.273739,-0.32361],
[9.445217,-0.30820],
[9.650217,-0.33667],
[9.787052,-0.34541],
[9.958566,-0.32780]])

# Franci results

data.append(
[[0.00000,0.000000],
[0.041851,0.000009],
[0.459482,0.002943],
[0.811132,0.003042],
[0.964979,0.003086],
[0.995160,-0.16592],
[0.991771,-0.37155],
[1.010034,-0.59690],
[1.006691,-0.79972],
[1.114539,-0.92363],
[1.141021,-0.65038],
[1.242522,-0.49261],
[1.396044,-0.51228],
[1.482982,-0.57141],
[1.669331,-0.59953],
[1.766840,-0.68401],
[1.910487,-0.63608],
[2.087194,-0.58251],
[2.199221,-0.45290],
[2.311340,-0.31766],
[2.358082,-0.14863],
[2.415814,0.020396],
[2.473220,0.169708],
[2.552186,0.293674],
[2.619142,0.355664],
[2.660823,0.217648],
[2.712101,-0.00487],
[2.764028,-0.18795],
[2.848783,-0.37948],
[2.944898,-0.54846],
[3.031371,-0.63576],
[3.099581,-0.49772],
[3.177572,-0.43291],
[3.276660,-0.42161],
[3.331048,-0.45540],
[3.452253,-0.43565],
[3.507801,-0.39901],
[3.552965,-0.32576],
[3.619782,-0.27222],
[3.795328,-0.28907],
[3.904290,-0.34538],
[3.948757,-0.31438],
[4.059205,-0.28055],
[4.223391,-0.31994],
[4.277407,-0.37626],
[4.354052,-0.39314],
[4.486710,-0.34521],
[4.618811,-0.33109],
[4.750680,-0.33105],
[4.871560,-0.33102],
[4.948019,-0.35917],
[5.101773,-0.36476],
[5.332868,-0.34498],
[5.432095,-0.32523],
[5.509575,-0.29140],
[5.597488,-0.29138],
[5.794780,-0.32231],
[5.970280,-0.34198],
[6.178654,-0.36727],
[6.354851,-0.34469],
[6.509023,-0.32493],
[6.706686,-0.33332],
[6.860533,-0.33328],
[6.948353,-0.33889],
[7.135074,-0.34447],
[7.377251,-0.31905],
[7.619196,-0.30771],
[7.860724,-0.32173],
[8.112961,-0.35264],
[8.211631,-0.36670],
[8.431830,-0.34129],
[8.597362,-0.29899],
[8.751348,-0.29049],
[8.915859,-0.31016],
[9.146119,-0.34108],
[9.321851,-0.34667],
[9.619299,-0.30151],
[9.959310,-0.34086]])

# Meduri results

data.append(
[[0.00000,0.000000],
[0.007115,0.001857],
[0.320171,0.001944],
[0.576307,0.002015],
[0.917823,0.002110],
[0.967627,-0.16851],
[0.981857,-0.29462],
[1.003202,-0.43928],
[1.003202,-0.59879],
[1.010317,-0.74345],
[1.038776,-0.87513],
[1.067236,-0.96971],
[1.138385,-0.80092],
[1.159730,-0.67850],
[1.188189,-0.55052],
[1.230879,-0.48744],
[1.280683,-0.46517],
[1.351832,-0.49297],
[1.430096,-0.47626],
[1.508360,-0.52446],
[1.607969,-0.58749],
[1.679118,-0.64497],
[1.743152,-0.68390],
[1.835646,-0.64678],
[1.899680,-0.62265],
[1.985059,-0.61335],
[2.091782,-0.55026],
[2.177161,-0.50202],
[2.212736,-0.41855],
[2.262540,-0.32209],
[2.305229,-0.22377],
[2.326574,-0.10878],
[2.390608,0.002520],
[2.433298,0.113815],
[2.490217,0.249224],
[2.525792,0.360517],
[2.589826,0.403193],
[2.646745,0.518202],
[2.732124,0.431054],
[2.760583,0.345745],
[2.796158,0.204796],
[2.817503,0.037878],
[2.881537,-0.22176],
[2.938456,-0.44245],
[2.995375,-0.65573],
[3.073639,-0.71135],
[3.144788,-0.62972],
[3.166133,-0.54069],
[3.223052,-0.43681],
[3.294201,-0.41083],
[3.358235,-0.39412],
[3.443614,-0.47570],
[3.528993,-0.42560],
[3.571683,-0.50348],
[3.721096,-0.27902],
[3.863394,-0.20108],
[3.934543,-0.27525],
[3.991462,-0.39208],
[4.027037,-0.42546],
[4.112415,-0.34568],
[4.183565,-0.28817],
[4.240484,-0.24364],
[4.404127,-0.32705],
[4.496620,-0.42904],
[4.560655,-0.40305],
[4.603344,-0.37893],
[4.695838,-0.32141],
[4.781217,-0.35292],
[4.838136,-0.36403],
[4.902170,-0.36957],
[4.944859,-0.38626],
[5.016009,-0.38253],
[5.080043,-0.41404],
[5.186766,-0.33055],
[5.314835,-0.33607],
[5.435788,-0.38983],
[5.471362,-0.36942],
[5.542512,-0.37496],
[5.620776,-0.33228],
[5.720384,-0.31927],
[5.791533,-0.31183],
[5.905372,-0.35631],
[6.004980,-0.37298],
[6.090359,-0.32102],
[6.225543,-0.32098],
[6.318036,-0.35991],
[6.417645,-0.38770],
[6.474564,-0.38768],
[6.595518,-0.34870],
[6.680896,-0.32271],
[6.823195,-0.35049],
[6.972608,-0.37085],
[7.086446,-0.34115],
[7.143365,-0.33557],
[7.228744,-0.34667],
[7.328353,-0.36704],
[7.406617,-0.36888],
[7.484881,-0.33362],
[7.591604,-0.30577],
[7.662753,-0.30575],
[7.797937,-0.34280],
[7.940235,-0.37058],
[8.082533,-0.34458],
[8.153682,-0.35198],
[8.253291,-0.37606],
[8.303095,-0.379761]])

# |--------------------------------|
# |   Post Procesing of Results    |
# |--------------------------------|

Y = list()
position = [0,-2.45,0]
os.chdir('workspace/metafor')

time,directory = tb.readFiles()
tag = tb.findNode(directory[0],position)

for file in directory:

    gmsh.open(file)
    Y.append(gmsh.model.mesh.getNode(tag)[0][1])

tb.plotRef(time,Y-Y[0],data)

