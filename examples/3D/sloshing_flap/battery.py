from matplotlib import pyplot as plt
from natsort import natsorted
import numpy as np
import os, gmsh

# Results from Suoto num

plt.plot(*np.transpose(
[[0.00000, 0.000000], [0.047510, -0.00107], [0.162310, -0.00064],
[0.281080, -0.00192], [0.384010, -0.00661], [0.443390, -0.01471],
[0.534440, -0.02793], [0.601740, -0.03945], [0.661120, -0.04712],
[0.740300, -0.05181], [0.831350, -0.04883], [0.910530, -0.03475],
[0.969910, -0.01812], [1.013460, -0.00320], [1.045130, 0.016420],
[1.084720, 0.034750], [1.120350, 0.052670], [1.171810, 0.064610],
[1.231200, 0.075270], [1.318290, 0.076120], [1.405380, 0.068020],
[1.464770, 0.056080], [1.528110, 0.036460], [1.559780, 0.020680],
[1.591450, 0.002350], [1.619160, -0.01557], [1.642910, -0.03305],
[1.682500, -0.05053], [1.722090, -0.06759], [1.777510, -0.07953],
[1.860650, -0.08380], [1.967540, -0.07868], [2.058590, -0.06247],
[2.121930, -0.03731], [2.185270, -0.00576], [2.216940, 0.018550],
[2.244660, 0.039450], [2.276330, 0.060340], [2.327790, 0.074840],
[2.399050, 0.084650], [2.478230, 0.083370], [2.565320, 0.072710],
[2.644500, 0.056500], [2.699920, 0.037310], [2.731590, 0.023240],
[2.767220, 0.001490], [2.794930, -0.01684], [2.818690, -0.03603],
[2.850360, -0.05565], [2.889940, -0.07058], [2.965160, -0.08337],
[3.068090, -0.08209], [3.151230, -0.07143], [3.226440, -0.05778],
[3.285830, -0.04030], [3.329370, -0.01642], [3.368960, 0.013860],
[3.400630, 0.037740], [3.436260, 0.057780], [3.471890, 0.071860],
[3.539190, 0.082520], [3.650040, 0.084220], [3.737130, 0.073990],
[3.816310, 0.059490], [3.855900, 0.041580], [3.895490, 0.023670],
[3.939030, -0.00021], [3.970700, -0.02111], [3.998420, -0.04243],
[4.034050, -0.06247], [4.081550, -0.07825], [4.140930, -0.08507],
[4.255740, -0.08081], [4.350750, -0.06972], [4.445760, -0.04371],
[4.485350, -0.02495], [4.520980, 0.001920], [4.552650, 0.026230],
[4.592240, 0.052240], [4.631830, 0.073130], [4.695170, 0.085930],
[4.790180, 0.087630], [4.869360, 0.077400], [4.996040, 0.054370]]))

# Results from Souto exp

plt.plot(*np.transpose(
[[0.00000, 0.000000], [0.051464, -0.00062], [0.273159, -0.00618],
[0.360253, -0.01342], [0.451306, -0.01982], [0.502771, -0.02578],
[0.562153, -0.03176], [0.629453, -0.03816], [0.791765, -0.03474],
[0.847189, -0.02834], [0.870942, -0.02238], [0.922406, -0.01300],
[0.954077, -0.00404], [0.985748, 0.003640], [1.005542, 0.010040],
[1.033254, 0.021980], [1.049089, 0.027520], [1.092636, 0.040300],
[1.104513, 0.047560], [1.191607, 0.057800], [1.334125, 0.056080],
[1.373713, 0.049700], [1.425178, 0.041160], [1.456848, 0.030500],
[1.492478, 0.023680], [1.500395, 0.017280], [1.532066, 0.010040],
[1.539984, 0.002780], [1.555819, -0.00362], [1.571654, -0.01002],
[1.579572, -0.01598], [1.611243, -0.02324], [1.623119, -0.02792],
[1.638954, -0.03432], [1.654790, -0.03986], [1.682501, -0.04840],
[1.698337, -0.05350], [1.726049, -0.05906], [1.785431, -0.06750],
[1.912114, -0.06502], [1.967537, -0.05820], [2.019002, -0.04924],
[2.066508, -0.03730], [2.106096, -0.02622], [2.141726, -0.01428],
[2.165479, -0.00318], [2.189231, 0.009600], [2.216943, 0.021540],
[2.252573, 0.033060], [2.280285, 0.047560], [2.323832, 0.057800],
[2.343626, 0.063340], [2.399049, 0.070160], [2.525732, 0.065040],
[2.596991, 0.057360], [2.628661, 0.051400], [2.656373, 0.045000],
[2.672209, 0.037740], [2.676167, 0.033060], [2.723673, 0.018980],
[2.751385, 0.007040], [2.779097, -0.00020], [2.790973, -0.00618],
[2.790973, -0.01256], [2.818685, -0.02452], [2.842438, -0.03090],
[2.850356, -0.03602], [2.858273, -0.04370], [2.878068, -0.04968],
[2.905779, -0.05478], [2.921615, -0.06288], [2.941409, -0.06886],
[3.048297, -0.07526], [3.143309, -0.06844], [3.190815, -0.05948],
[3.210609, -0.05478], [3.234362, -0.04754], [3.281868, -0.03772],
[3.293745, -0.03090], [3.333333, -0.01768], [3.337292, -0.01256],
[3.368962, -0.00618], [3.400633, 0.010460], [3.416468, 0.016420],
[3.448139, 0.026660], [3.460015, 0.036040], [3.507521, 0.055240],
[3.543151, 0.061200], [3.634204, 0.070580], [3.737133, 0.065900],
[3.792557, 0.057360], [3.824228, 0.051400], [3.847980, 0.044140],
[3.883610, 0.037740], [3.891528, 0.031780], [3.907363, 0.024540],
[3.927157, 0.019420], [3.942992, 0.012580], [3.954869, 0.006620],
[3.982581, -0.00106], [3.982581, -0.00660], [3.994457, -0.01256],
[4.006334, -0.01854], [4.018210, -0.02408], [4.030087, -0.03134],
[4.049881, -0.03816], [4.077593, -0.04456], [4.093428, -0.05180],
[4.113222, -0.05820], [4.148851, -0.06672], [4.196357, -0.07356],
[4.311163, -0.07142], [4.378463, -0.06374], [4.418052, -0.05734],
[4.449722, -0.05052], [4.477434, -0.04072], [4.505146, -0.03134],
[4.524940, -0.02536], [4.536817, -0.01940], [4.544734, -0.01342],
[4.572446, -0.00532], [4.576405, -0.00106], [4.592240, 0.005760],
[4.600158, 0.011740], [4.623911, 0.018560], [4.631828, 0.024100],
[4.651623, 0.030920], [4.647664, 0.035200], [4.675376, 0.040740],
[4.671417, 0.046700], [4.718923, 0.057800], [4.790182, 0.068460],
[4.952494, 0.063760], [5.003958, 0.056520]]))

# Results from Ng

plt.plot(*np.transpose(
[[0.00000, 0.000000], [0.118764, 0.000213], [0.245447, -0.00106],
[0.352335, -0.00447], [0.451306, -0.01300], [0.534441, -0.02452],
[0.597783, -0.03390], [0.673000, -0.04243], [0.752177, -0.04584],
[0.839271, -0.04200], [0.906571, -0.03219], [0.961995, -0.01940],
[1.001583, -0.00575], [1.041171, 0.010874], [1.080760, 0.027078],
[1.116389, 0.042004], [1.163895, 0.055650], [1.223277, 0.066311],
[1.294536, 0.069296], [1.389548, 0.064179], [1.460807, 0.053518],
[1.512272, 0.040724], [1.567695, 0.022814], [1.603325, 0.007889],
[1.631037, -0.00703], [1.654790, -0.02238], [1.678543, -0.03560],
[1.706254, -0.04840], [1.741884, -0.06119], [1.781472, -0.07014],
[1.852731, -0.07739], [1.920031, -0.07654], [2.003167, -0.06929],
[2.082343, -0.05650], [2.137767, -0.04072], [2.169437, -0.02665],
[2.201108, -0.01257], [2.236737, 0.008315], [2.260490, 0.025373],
[2.296120, 0.045415], [2.339667, 0.062473], [2.395091, 0.074840],
[2.458432, 0.079104], [2.541567, 0.076972], [2.612826, 0.069296],
[2.684085, 0.055650], [2.727632, 0.042004], [2.771179, 0.025373],
[2.810768, 0.006183], [2.834520, -0.01002], [2.854315, -0.02324],
[2.882026, -0.03774], [2.917656, -0.05437], [2.953285, -0.06801],
[3.004750, -0.07782], [3.091844, -0.08081], [3.174980, -0.07441],
[3.254156, -0.06204], [3.301662, -0.04840], [3.349168, -0.03219],
[3.384798, -0.01556], [3.416468, 0.004477], [3.448139, 0.025799],
[3.479809, 0.045415], [3.527315, 0.061620], [3.578780, 0.074840],
[3.653998, 0.080810], [3.745051, 0.076972], [3.812351, 0.067590],
[3.875692, 0.053518], [3.939034, 0.030064], [3.978622, 0.009594],
[4.014251, -0.01002], [4.041963, -0.03049], [4.077593, -0.04882],
[4.117181, -0.06418], [4.176563, -0.07654], [4.255740, -0.08081],
[4.346793, -0.07569], [4.414093, -0.06503], [4.469517, -0.05181],
[4.513064, -0.03475], [4.548693, -0.01983], [4.580364, -0.00063],
[4.608076, 0.015565], [4.639746, 0.036460], [4.687252, 0.058635],
[4.742676, 0.072707], [4.829770, 0.081236], [4.908946, 0.078678],
[4.980205, 0.071002]]))

# List the output files in workspace

gmsh.initialize()
gmsh.option.setNumber('General.Terminal', 0)
directory = natsorted(os.listdir('metafor'))

# Extract the results from Gmsh

time = list()
result = list()

for file in directory:

    gmsh.open(f'metafor/{file}')

    time.append(float(file.replace('.msh', '').replace('output_', '')))
    distance = gmsh.model.mesh.getNode(216)[0][0]
    result.append(distance)

# Plot the results on the graph

plt.grid(color='lightgray')
plt.plot(time, result, '--k')
plt.savefig('plot.pdf', format='pdf')
