import os,sys
sys.path.append('examples')
import toolbox as tb
import gmsh

# |-------------------------------|
# |   Data From the Literature    |
# |-------------------------------|

data = list()

# Marti results

data.append(
[[0.00000,0.000324],
[0.118928,0.000324],
[0.140704,-0.00008],
[0.149079,-0.00008],
[0.165829,0.001147],
[0.190955,0.006706],
[0.207705,0.014529],
[0.222781,0.024000],
[0.241206,0.036559],
[0.264657,0.049735],
[0.286432,0.058588],
[0.316583,0.063735],
[0.343384,0.061882],
[0.370184,0.054471],
[0.385260,0.048706],
[0.412060,0.034294],
[0.433836,0.020500],
[0.455611,0.008353],
[0.484087,-0.00667],
[0.510888,-0.01861],
[0.536013,-0.02376],
[0.554439,-0.02520],
[0.572864,-0.02335],
[0.594640,-0.01841],
[0.623116,-0.00688],
[0.658291,0.010824],
[0.686767,0.023382],
[0.705193,0.027500],
[0.720268,0.029147],
[0.737018,0.027706],
[0.753769,0.024206],
[0.777219,0.015353],
[0.795645,0.004441],
[0.809045,-0.00420],
[0.825796,-0.01614],
[0.844221,-0.02705],
[0.867672,-0.03797],
[0.891122,-0.04373],
[0.902848,-0.04476],
[0.924623,-0.04270],
[0.948074,-0.03673],
[0.973199,-0.02602],
[0.998325,-0.01223],
[1.020101,0.000735],
[1.043551,0.011441],
[1.067002,0.021529],
[1.085427,0.026265],
[1.105528,0.027912],
[1.128978,0.025235],
[1.150754,0.018647],
[1.175879,0.007118],
[1.199330,-0.00441],
[1.222781,-0.01491],
[1.244556,-0.02129],
[1.266332,-0.02294],
[1.291457,-0.02047],
[1.319933,-0.01161],
[1.341709,-0.00235],
[1.365159,0.009176],
[1.393635,0.019676],
[1.422111,0.023794],
[1.443886,0.021941],
[1.462312,0.017412],
[1.479062,0.011235],
[1.499162,0.004235],
[1.524288,-0.00461],
[1.547739,-0.00894],
[1.566164,-0.00976],
[1.591290,-0.00873],
[1.618090,-0.00379],
[1.653266,0.005265],
[1.688442,0.012882],
[1.718593,0.015765],
[1.753769,0.013294],
[1.778894,0.007529],
[1.814070,-0.00214],
[1.845896,-0.00914],
[1.877722,-0.01161],
[1.902848,-0.00955],
[1.926298,-0.00502],
[1.964824,0.003824],
[2.000000,0.011029]])

# |--------------------------------|
# |   Post Procesing of Results    |
# |--------------------------------|

X = list()
position = [0.277,0,0.15]
os.chdir('workspace/metafor')

time,directory = tb.readFiles()
tag = tb.findNode(directory[0],position)

for file in directory:

    gmsh.open(file)
    X.append(gmsh.model.mesh.getNode(tag)[0][0])

tb.plotRef(time,X-X[0],data)